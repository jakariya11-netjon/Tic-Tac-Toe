<!-- FULL COMBINED GAME (Easy AI) — Auto-reset 3s + user sound filenames preserved -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic Tac Toe — Easy AI</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #0f172a;
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .game-box {
            background: #1e293b;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            width: 320px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
        }

        .board {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(3, 90px);
            gap: 10px;
            justify-content: center;
        }

        .cell {
            width: 90px;
            height: 90px;
            background: #334155;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            position: relative;
            overflow: hidden;
            user-select: none;
        }

        .cell:hover {
            background: #475569;
            transform: translateY(-2px);
        }

        .btn {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            background: #0ea5e9;
            border: none;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
        }

        .btn:hover {
            background: #0284c7;
        }

        .small-btn {
            margin-top: 10px;
            padding: 6px 10px;
            font-size: 14px;
            background: #22c55e;
            border: none;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
        }

        .small-btn:hover {
            background: #15803d;
        }

        .winner {
            animation: glowScale 0.7s ease forwards;
            box-shadow: 0 0 20px #ff4500;
        }

        @keyframes glowScale {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.25);
                box-shadow: 0 0 30px #ff7700;
            }

            100% {
                transform: scale(1.15);
                box-shadow: 0 0 25px #ff3300;
            }
        }

        .explosion {
            position: absolute;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #ffcc00, #ff5500, #ff0000);
            border-radius: 50%;
            animation: boom 0.5s ease-out forwards;
            opacity: 0.9;
            z-index: 5;
            left: -15px;
            top: -15px;
            pointer-events: none;
        }

        @keyframes boom {
            0% {
                transform: scale(0.2);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.4);
                opacity: 1;
            }

            100% {
                transform: scale(0);
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div class="game-box">
        <h2>Tic Tac Toe</h2>
        <div id="status">Turn: <span id="turn">X</span></div>
        <div class="board" id="board"></div>
        <button id="reset" class="btn">Restart Game</button>
        <button id="toggleMode" class="small-btn">Play vs Computer: OFF</button>
    </div>

    <!-- Sounds: filenames preserved -->
    <audio id="tapSound" src="pop-402322.mp3"></audio>
    <audio id="winSound" src="loud-fanfare-trumpet-effect-05-412046.mp3"></audio>
    <audio id="tieSound" src="tie.mp3"></audio>
    <audio id="loseSound" src="loss.mp3"></audio>

    <script>
        const board = document.getElementById("board");
        const statusBox = document.getElementById("status");
        let turnText = document.getElementById("turn");
        const resetBtn = document.getElementById("reset");
        const modeBtn = document.getElementById("toggleMode");

        const tapSound = document.getElementById("tapSound");
        const winSound = document.getElementById("winSound");
        const tieSound = document.getElementById("tieSound");
        const loseSound = document.getElementById("loseSound");

        let gameActive = true;
        let currentPlayer = "X";
        let cells = Array(9).fill("");
        let vsComputer = false;
        let autoResetTimer = null;

        function createBoard() {
            board.innerHTML = "";
            cells.forEach((v, i) => {
                const div = document.createElement("div");
                div.classList.add("cell");
                div.onclick = () => handleClick(i);
                board.appendChild(div);
            });
        }

        function handleClick(i) {
            if (!gameActive || cells[i] !== "") return;

            // If vsComputer AND it's not player's (X) turn then ignore clicks.
            if (vsComputer && currentPlayer !== "X") return;

            playerMove(i);

            // AI should run ONLY when computer mode ON AND it is O's turn
            if (vsComputer && gameActive && currentPlayer === "O") {
                setTimeout(() => computerMoveEasy(), 300);
            }
        }

        function playerMove(i) {
            cells[i] = currentPlayer;
            board.children[i].textContent = currentPlayer;
            safePlay(tapSound);

            const winPattern = checkWin();
            if (winPattern) {
                triggerWinEffect(winPattern);
                return;
            }

            if (!cells.includes("")) {
                statusBox.innerHTML = "It's a Tie!";
                gameActive = false;
                safePlay(tieSound);
                scheduleAutoReset();
                return;
            }

            // switch turn
            currentPlayer = currentPlayer === "X" ? "O" : "X";
            if (turnText) turnText.textContent = currentPlayer;
        }

        // --------------------------
        // Easy AI (random with center preference)
        // --------------------------
        function computerMoveEasy() {
            if (!gameActive) return;
            if (currentPlayer !== "O") return;

            let empty = [];
            cells.forEach((v, i) => { if (v === "") empty.push(i); });
            if (empty.length === 0) return;

            // prefer center if free
            if (cells[4] === "") {
                makeComputerPlay(4);
                return;
            }

            // pick a random empty cell
            const pick = empty[Math.floor(Math.random() * empty.length)];
            makeComputerPlay(pick);
        }

        function makeComputerPlay(index) {
            cells[index] = "O";
            board.children[index].textContent = "O";
            safePlay(tapSound);

            const winPattern = checkWin();
            if (winPattern) {
                triggerWinEffect(winPattern);
                return;
            }

            if (!cells.includes("")) {
                statusBox.innerHTML = "It's a Tie!";
                gameActive = false;
                safePlay(tieSound);
                scheduleAutoReset();
                return;
            }

            currentPlayer = "X";
            if (turnText) turnText.textContent = currentPlayer;
        }

        // --------------------------
        // Helpers: win check, effects, reset, sounds
        // --------------------------
        function checkWin() {
            const pattern = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6]
            ];
            for (let p of pattern) {
                const [a, b, c] = p;
                if (cells[a] && cells[a] === cells[b] && cells[a] === cells[c]) return p;
            }
            return null;
        }

        function triggerWinEffect(pattern) {
            if (autoResetTimer) { clearTimeout(autoResetTimer); autoResetTimer = null; }

            gameActive = false;
            statusBox.innerHTML = `${currentPlayer} Wins!`;
            safePlay(winSound);

            pattern.forEach(i => {
                let cell = board.children[i];
                cell.classList.add("winner");
                let boom = document.createElement("div");
                boom.classList.add("explosion");
                cell.appendChild(boom);
                setTimeout(() => { if (boom && boom.remove) boom.remove(); }, 700);
            });

            if (currentPlayer === 'O') safePlay(loseSound);
            scheduleAutoReset();
        }

        function scheduleAutoReset() {
            if (autoResetTimer) clearTimeout(autoResetTimer);
            autoResetTimer = setTimeout(() => {
                resetBtn.click();
                autoResetTimer = null;
            }, 3000);
        }

        function safePlay(audio) {
            if (!audio) return;
            try {
                audio.currentTime = 0;
                const p = audio.play();
                if (p && p.catch) p.catch(() => { });
            } catch (e) { }
        }

        // RESET: re-query the #turn span after innerHTML changes on reset
        resetBtn.onclick = () => {
            if (autoResetTimer) { clearTimeout(autoResetTimer); autoResetTimer = null; }

            cells = Array(9).fill("");
            currentPlayer = "X";

            // recreate status HTML (new <span id="turn">)
            statusBox.innerHTML = "Turn: <span id='turn'>X</span>";

            // refresh reference to new span
            turnText = document.getElementById("turn");
            if (turnText) turnText.textContent = "X";

            gameActive = true;
            createBoard();
        };

        modeBtn.onclick = () => {
            vsComputer = !vsComputer;
            modeBtn.textContent = vsComputer ? "Play vs Computer: ON" : "Play vs Computer: OFF";
            resetBtn.click();
        };

        // initial setup
        createBoard();
    </script>
</body>

</html>